<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Typing Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #48bb78;
            --error-color: #f56565;
            --warning-color: #ed8936;
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --bg-primary: #f7fafc;
            --bg-secondary: #ffffff;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: var(--text-primary);
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: var(--bg-secondary);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            padding: 25px 30px;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
        }

        .stat-item {
            text-align: center;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary-color);
            display: block;
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.85em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        .typing-area {
            padding: 40px 30px;
        }

        .words-display {
            font-size: 1.5em;
            line-height: 2;
            color: var(--text-secondary);
            margin-bottom: 30px;
            padding: 30px;
            background: var(--bg-primary);
            border-radius: 12px;
            border: 2px solid var(--border-color);
            min-height: 150px;
            position: relative;
            overflow: hidden;
        }

        .word {
            display: inline-block;
            margin: 0 6px;
            position: relative;
            transition: all 0.2s ease;
        }

        .word.current {
            background: linear-gradient(135deg, #667eea20, #764ba220);
            padding: 2px 6px;
            border-radius: 4px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }

        .word.correct {
            color: var(--success-color);
            animation: correctPop 0.3s ease-out;
        }

        @keyframes correctPop {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        .word.incorrect {
            color: var(--error-color);
            animation: shake 0.3s ease-out;
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-4px);
            }
            75% {
                transform: translateX(4px);
            }
        }

        .letter {
            position: relative;
            transition: all 0.1s ease;
        }

        .letter.correct {
            color: var(--success-color);
        }

        .letter.incorrect {
            color: var(--error-color);
            animation: letterShake 0.2s ease-out;
        }

        @keyframes letterShake {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(-2px);
            }
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.5em;
            background: var(--primary-color);
            margin-left: 1px;
            animation: blink 1s infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            0%, 50% {
                opacity: 1;
            }
            51%, 100% {
                opacity: 0;
            }
        }

        .input-wrapper {
            position: relative;
        }

        #typingInput {
            width: 100%;
            padding: 20px;
            font-size: 1.2em;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            outline: none;
            transition: all 0.3s ease;
            background: var(--bg-primary);
        }

        #typingInput:focus {
            border-color: var(--primary-color);
            background: var(--bg-secondary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            padding: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            font-size: 1.1em;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--bg-primary);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }

        .results-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .results-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .results-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            transform: scale(0.8);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        .results-modal.show .results-content {
            transform: scale(1);
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .results-header h2 {
            font-size: 2em;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-item {
            text-align: center;
            padding: 20px;
            background: var(--bg-primary);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .result-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .result-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary-color);
            display: block;
            margin-bottom: 5px;
        }

        .result-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-ring {
            display: inline-block;
            position: relative;
            width: 150px;
            height: 150px;
            margin: 20px auto;
        }

        .progress-ring svg {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            fill: none;
            stroke: var(--border-color);
            stroke-width: 10;
        }

        .progress-ring-circle-progress {
            fill: none;
            stroke: url(#gradient);
            stroke-width: 10;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }

        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2em;
            font-weight: 700;
            color: var(--primary-color);
        }

        .time-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .time-btn {
            padding: 8px 20px;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-primary);
        }

        .time-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .time-btn:hover:not(.active) {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .words-display {
                font-size: 1.2em;
                padding: 20px;
            }
            
            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚å®Ô∏è Professional Typing Test</h1>
            <p>Test your typing speed and accuracy</p>
        </div>
        
        <div class="time-selector">
            <button class="time-btn" data-time="30">30s</button>
            <button class="time-btn active" data-time="60">1 min</button>
            <button class="time-btn" data-time="120">2 min</button>
            <button class="time-btn" data-time="300">5 min</button>
        </div>
        
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-value" id="wpm">0</span>
                <span class="stat-label">WPM</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="accuracy">100%</span>
                <span class="stat-label">Accuracy</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="time">60s</span>
                <span class="stat-label">Time</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="characters">0</span>
                <span class="stat-label">Characters</span>
            </div>
        </div>
        
        <div class="typing-area">
            <div class="words-display" id="wordsDisplay"></div>
            <div class="input-wrapper">
                <input type="text" id="typingInput" placeholder="Click here and start typing..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" id="startBtn">Start Test</button>
            <button class="btn btn-secondary" id="resetBtn">Reset</button>
        </div>
    </div>
    
    <div class="results-modal" id="resultsModal">
        <div class="results-content">
            <div class="results-header">
                <h2>üéâ Test Complete!</h2>
                <p>Great job! Here are your results:</p>
            </div>
            
            <div class="progress-ring">
                <svg width="150" height="150">
                    <defs>
                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <circle class="progress-ring-circle" cx="75" cy="75" r="65"></circle>
                    <circle class="progress-ring-circle-progress" id="progressCircle" cx="75" cy="75" r="65"></circle>
                </svg>
                <div class="progress-percentage" id="finalAccuracy">0%</div>
            </div>
            
            <div class="result-grid">
                <div class="result-item">
                    <span class="result-value" id="finalWPM">0</span>
                    <span class="result-label">WPM</span>
                </div>
                <div class="result-item">
                    <span class="result-value" id="finalCorrect">0</span>
                    <span class="result-label">Correct Words</span>
                </div>
                <div class="result-item">
                    <span class="result-value" id="finalErrors">0</span>
                    <span class="result-label">Errors</span>
                </div>
                <div class="result-item">
                    <span class="result-value" id="finalChars">0</span>
                    <span class="result-label">Total Characters</span>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" id="tryAgainBtn">Try Again</button>
            </div>
        </div>
    </div>
    
    <script>
        // Word bank for the typing test
       const words = [
    'ability', 'able', 'about', 'above', 'accept', 'according', 'account', 'across', 'action', 'activity',
    'actually', 'address', 'administration', 'admit', 'adult', 'affect', 'after', 'again', 'against', 'agency',
    'agent', 'agree', 'agreement', 'ahead', 'allow', 'almost', 'alone', 'along', 'already', 'also',
    'although', 'always', 'american', 'among', 'amount', 'analysis', 'another', 'answer', 'anyone', 'anything',
    'appear', 'apply', 'approach', 'area', 'argue', 'around', 'arrive', 'article', 'artist', 'assume',
    'attack', 'attention', 'attorney', 'audience', 'author', 'authority', 'available', 'avoid', 'away', 'baby',
    'back', 'bad', 'ball', 'bank', 'base', 'be', 'beat', 'beautiful', 'because', 'become',
    'bed', 'before', 'begin', 'behavior', 'behind', 'believe', 'benefit', 'best', 'better', 'between',
    'beyond', 'big', 'bill', 'billion', 'bit', 'black', 'blood', 'blue', 'board', 'body',
    'book', 'born', 'both', 'box', 'boy', 'break', 'bring', 'brother', 'budget', 'build',
    'building', 'business', 'but', 'buy', 'by', 'call', 'camera', 'campaign', 'can', 'cancer',
    'candidate', 'capital', 'car', 'card', 'care', 'career', 'carry', 'case', 'catch', 'cause',
    'cell', 'center', 'central', 'century', 'certain', 'certainly', 'chair', 'challenge', 'chance', 'change',
    'character', 'charge', 'check', 'child', 'choice', 'choose', 'church', 'citizen', 'city', 'civil',
    'claim', 'class', 'clear', 'clearly', 'close', 'coach', 'cold', 'collection', 'college', 'color',
    'come', 'commercial', 'common', 'community', 'company', 'compare', 'computer', 'concern', 'condition', 'conference',
    'congress', 'consider', 'consumer', 'contain', 'continue', 'control', 'cost', 'could', 'country', 'couple',
    'course', 'court', 'cover', 'create', 'crime', 'cultural', 'culture', 'cup', 'current', 'customer',
    'cut', 'dark', 'data', 'daughter', 'day', 'dead', 'deal', 'death', 'debate', 'decade',
    'decide', 'decision', 'deep', 'defense', 'degree', 'democrat', 'democratic', 'describe', 'design', 'despite',
    'detail', 'determine', 'develop', 'development', 'die', 'difference', 'different', 'difficult', 'dinner', 'direction',
    'director', 'discover', 'discuss', 'discussion', 'disease', 'do', 'doctor', 'dog', 'door', 'down',
    'draw', 'dream', 'drive', 'drop', 'drug', 'during', 'each', 'early', 'east', 'easy',
    'eat', 'economic', 'economy', 'edge', 'education', 'effect', 'effort', 'eight', 'either', 'election',
    'else', 'employee', 'end', 'energy', 'enjoy', 'enough', 'enter', 'entire', 'environment', 'environmental',
    'especially', 'establish', 'even', 'evening', 'event', 'ever', 'every', 'everybody', 'everyone', 'everything',
    'evidence', 'exactly', 'example', 'executive', 'exist', 'expect', 'experience', 'expert', 'explain', 'eye',
    'face', 'fact', 'factor', 'fail', 'fall', 'family', 'far', 'fast', 'father', 'fear',
    'federal', 'feel', 'feeling', 'few', 'field', 'fight', 'figure', 'fill', 'film', 'final'
];

let gameState = {
    isStarted: false,
    currentWordIndex: 0,
    currentLetterIndex: 0,
    correctWords: 0,
    incorrectWords: 0,
    totalCharacters: 0,
    correctCharacters: 0,
    startTime: null,
    timeLimit: 60,
    timeRemaining: 60,
    timerInterval: null,
    generatedWords: [],
    typedWords: [],
    mistakes: 0,
};

const wordsDisplay = document.getElementById('wordsDisplay');
const typingInput = document.getElementById('typingInput');
const startBtn = document.getElementById('startBtn');
const resetBtn = document.getElementById('resetBtn');
const wpmDisplay = document.getElementById('wpm');
const accuracyDisplay = document.getElementById('accuracy');
const timeDisplay = document.getElementById('time');
const charactersDisplay = document.getElementById('characters');
const resultsModal = document.getElementById('resultsModal');
const tryAgainBtn = document.getElementById('tryAgainBtn');
const timeButtons = document.querySelectorAll('.time-btn');

function init() {
    resetState();
    generateWords();
    displayWords();
    setupEventListeners();
}

function resetState() {
    gameState = {
        isStarted: false,
        currentWordIndex: 0,
        currentLetterIndex: 0,
        correctWords: 0,
        incorrectWords: 0,
        totalCharacters: 0,
        correctCharacters: 0,
        startTime: null,
        timeLimit: gameState.timeLimit,
        timeRemaining: gameState.timeLimit,
        timerInterval: null,
        generatedWords: [],
        typedWords: [],
        mistakes: 0,
    };
    clearInterval(gameState.timerInterval);
    typingInput.value = '';
    typingInput.disabled = false;
    startBtn.textContent = 'Start Test';
    startBtn.disabled = false;
    timeDisplay.textContent = gameState.timeLimit + 's';
    wpmDisplay.textContent = '0';
    accuracyDisplay.textContent = '100%';
    charactersDisplay.textContent = '0';
    typingInput.focus();
}

function generateWords() {
    gameState.generatedWords = [];
    for (let i = 0; i < 200; i++) {
        const randomWord = words[Math.floor(Math.random() * words.length)];
        gameState.generatedWords.push(randomWord);
    }
}

function displayWords() {
    wordsDisplay.innerHTML = '';
    gameState.generatedWords.forEach((word, index) => {
        const wordSpan = document.createElement('span');
        wordSpan.className = 'word';
        wordSpan.dataset.index = index;
        
        for (let letter of word) {
            const letterSpan = document.createElement('span');
            letterSpan.className = 'letter';
            letterSpan.textContent = letter;
            wordSpan.appendChild(letterSpan);
        }
        wordsDisplay.appendChild(wordSpan);
        
        if (index < gameState.generatedWords.length - 1) {
            const spaceSpan = document.createElement('span');
            spaceSpan.textContent = ' ';
            wordsDisplay.appendChild(spaceSpan);
        }
    });
    updateCursorPosition();
}

function setupEventListeners() {
    typingInput.addEventListener('input', handleTyping);
    typingInput.addEventListener('keydown', handleKeyDown);
    startBtn.addEventListener('click', startTest);
    resetBtn.addEventListener('click', resetTest);
    tryAgainBtn.addEventListener('click', () => {
        resultsModal.classList.remove('show');
        resetTest();
    });
    
    timeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            if (!gameState.isStarted) {
                timeButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameState.timeLimit = parseInt(btn.dataset.time);
                gameState.timeRemaining = gameState.timeLimit;
                timeDisplay.textContent = gameState.timeLimit + 's';
            }
        });
    });
}

function handleTyping(e) {
    if (!gameState.isStarted) return;
    
    const typedValue = e.target.value;
    const currentWord = gameState.generatedWords[gameState.currentWordIndex];
    const currentWordElement = document.querySelector(`.word[data-index="${gameState.currentWordIndex}"]`);

    const letters = currentWordElement.querySelectorAll('.letter');
    
    // Reset all letter classes first for accurate visual state
    for (let i = 0; i < letters.length; i++) {
        letters[i].classList.remove('correct', 'incorrect');
    }
    
    let isCorrect = true;
    for (let i = 0; i < typedValue.length; i++) {
        if (i < letters.length) {
            if (typedValue[i] === currentWord[i]) {
                letters[i].classList.add('correct');
            } else {
                letters[i].classList.add('incorrect');
                isCorrect = false;
            }
        } else {
            // Handle extra typed characters
            isCorrect = false;
        }
    }
    
    gameState.currentLetterIndex = typedValue.length;
    updateCursorPosition();
    updateStats();
}

function handleKeyDown(e) {
    if (!gameState.isStarted) return;
    
    if (e.key === ' ') {
        e.preventDefault();
        const typedValue = typingInput.value.trim();
        const currentWord = gameState.generatedWords[gameState.currentWordIndex];
        
        if (typedValue === currentWord) {
            gameState.correctWords++;
            document.querySelector(`.word[data-index="${gameState.currentWordIndex}"]`).classList.add('correct');
        } else {
            gameState.incorrectWords++;
            document.querySelector(`.word[data-index="${gameState.currentWordIndex}"]`).classList.add('incorrect');
        }
        
        gameState.totalCharacters += typedValue.length;
        
        if (typedValue.length > currentWord.length || typedValue.length < currentWord.length || !isInputCorrect(typedValue, currentWord)) {
            gameState.mistakes++;
        }

        // Move to next word
        document.querySelector(`.word[data-index="${gameState.currentWordIndex}"]`).classList.remove('current');
        gameState.currentWordIndex++;
        gameState.currentLetterIndex = 0;
        
        if (gameState.currentWordIndex < gameState.generatedWords.length) {
            updateCursorPosition();
            checkAndScroll();
        } else {
            endTest();
        }
        
        typingInput.value = '';
        updateStats();
    }
}

function isInputCorrect(typed, correct) {
    if (typed.length !== correct.length) return false;
    for (let i = 0; i < typed.length; i++) {
        if (typed[i] !== correct[i]) {
            return false;
        }
    }
    return true;
}

function updateCursorPosition() {
    const allWords = wordsDisplay.querySelectorAll('.word');
    if (allWords.length === 0) return;

    const currentWordElement = allWords[gameState.currentWordIndex];
    const letters = currentWordElement.querySelectorAll('.letter');

    // Remove existing cursor
    const existingCursor = document.querySelector('.cursor');
    if (existingCursor) existingCursor.remove();

    // Create and position new cursor
    const cursor = document.createElement('span');
    cursor.className = 'cursor';
    
    if (gameState.currentLetterIndex < letters.length) {
        currentWordElement.insertBefore(cursor, letters[gameState.currentLetterIndex]);
    } else {
        currentWordElement.appendChild(cursor);
    }

    currentWordElement.classList.add('current');
}

function checkAndScroll() {
    const allWords = wordsDisplay.querySelectorAll('.word');
    const currentWordElement = allWords[gameState.currentWordIndex];
    const containerRect = wordsDisplay.getBoundingClientRect();
    const wordRect = currentWordElement.getBoundingClientRect();
    
    if (wordRect.top > containerRect.bottom - 50) {
        wordsDisplay.scrollTop += 50;
    }
}

function startTest() {
    if (gameState.isStarted) return;
    
    gameState.isStarted = true;
    gameState.startTime = Date.now();
    typingInput.focus();
    typingInput.disabled = false;
    startBtn.textContent = 'Testing...';
    startBtn.disabled = true;
    
    gameState.timerInterval = setInterval(() => {
        gameState.timeRemaining--;
        timeDisplay.textContent = gameState.timeRemaining + 's';
        
        if (gameState.timeRemaining <= 0) {
            endTest();
        }
    }, 1000);
}

function endTest() {
    gameState.isStarted = false;
    clearInterval(gameState.timerInterval);
    typingInput.disabled = true;
    
    const timeTakenInMinutes = (gameState.timeLimit - gameState.timeRemaining) / 60;
    
    // WPM calculation
    const wpm = Math.round(gameState.correctWords / timeTakenInMinutes);
    
    // Accuracy calculation
    const totalWords = gameState.correctWords + gameState.incorrectWords;
    const accuracy = totalWords > 0 ? Math.round((gameState.correctWords / totalWords) * 100) : 0;
    
    // Display results in modal
    document.getElementById('finalWPM').textContent = wpm;
    document.getElementById('finalCorrect').textContent = gameState.correctWords;
    document.getElementById('finalErrors').textContent = gameState.incorrectWords;
    
    const allLetters = wordsDisplay.querySelectorAll('.letter');
    let totalTypedChars = 0;
    let correctTypedChars = 0;

    for(let i=0; i<gameState.currentWordIndex; i++){
        const typedWord = gameState.typedWords[i];
        const correctWord = gameState.generatedWords[i];
        totalTypedChars += typedWord.length;
        for(let j=0; j<typedWord.length; j++){
            if(typedWord[j] === correctWord[j]){
                correctTypedChars++;
            }
        }
    }
    document.getElementById('finalChars').textContent = totalTypedChars;

    const finalAccuracy = totalTypedChars > 0 ? Math.round((correctTypedChars / totalTypedChars) * 100) : 0;
    document.getElementById('finalAccuracy').textContent = finalAccuracy + '%';

    // Update progress ring
    const radius = 65;
    const circumference = 2 * Math.PI * radius;
    const progressCircle = document.getElementById('progressCircle');
    progressCircle.style.strokeDasharray = `${circumference} ${circumference}`;
    const offset = circumference - (finalAccuracy / 100) * circumference;
    progressCircle.style.strokeDashoffset = offset;
    
    resultsModal.classList.add('show');
}

function updateStats() {
    const elapsedTime = (Date.now() - gameState.startTime) / 1000;
    const wordsPerMinute = Math.round((gameState.correctWords / elapsedTime) * 60);
    const totalTypedWords = gameState.correctWords + gameState.incorrectWords;
    const accuracy = totalTypedWords > 0 ? Math.round((gameState.correctWords / totalTypedWords) * 100) : 100;

    wpmDisplay.textContent = isNaN(wordsPerMinute) ? 0 : wordsPerMinute;
    accuracyDisplay.textContent = accuracy + '%';
    charactersDisplay.textContent = gameState.totalCharacters;
}

function resetTest() {
    init();
}

init();

</script>
</body>
</html>